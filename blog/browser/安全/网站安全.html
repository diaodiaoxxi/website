<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网站安全 | 前端小站</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/website/blog/assets/favicon.ico">
    <script type="text/javascript" src="https://cms.hs.net/r/cms/www/itn/js/userAnalysis.js?appkey=NjRfMQ==" async="true" id="user_analysis_id"></script>
    <meta name="description" content="~">
    <link rel="preload" href="/website/blog/assets/css/0.styles.edf1fc31.css" as="style"><link rel="preload" href="/website/blog/assets/js/app.a3a72a23.js" as="script"><link rel="preload" href="/website/blog/assets/js/7.e5a4a7de.js" as="script"><link rel="preload" href="/website/blog/assets/js/59.d8341454.js" as="script"><link rel="preload" href="/website/blog/assets/js/37.133e5c9b.js" as="script"><link rel="prefetch" href="/website/blog/assets/js/1.35396e1f.js"><link rel="prefetch" href="/website/blog/assets/js/10.bcb9a348.js"><link rel="prefetch" href="/website/blog/assets/js/11.026d1919.js"><link rel="prefetch" href="/website/blog/assets/js/12.00d4c28a.js"><link rel="prefetch" href="/website/blog/assets/js/13.4681dd7d.js"><link rel="prefetch" href="/website/blog/assets/js/14.08665e8c.js"><link rel="prefetch" href="/website/blog/assets/js/15.74c3e15f.js"><link rel="prefetch" href="/website/blog/assets/js/16.360f2fb7.js"><link rel="prefetch" href="/website/blog/assets/js/17.fa7d626a.js"><link rel="prefetch" href="/website/blog/assets/js/18.13be786d.js"><link rel="prefetch" href="/website/blog/assets/js/19.23680e51.js"><link rel="prefetch" href="/website/blog/assets/js/2.664274c1.js"><link rel="prefetch" href="/website/blog/assets/js/20.55f3b4e3.js"><link rel="prefetch" href="/website/blog/assets/js/21.8942f4b2.js"><link rel="prefetch" href="/website/blog/assets/js/22.da67ecd7.js"><link rel="prefetch" href="/website/blog/assets/js/23.a89b2b02.js"><link rel="prefetch" href="/website/blog/assets/js/24.723a2bd9.js"><link rel="prefetch" href="/website/blog/assets/js/25.82636da4.js"><link rel="prefetch" href="/website/blog/assets/js/26.af7c40cb.js"><link rel="prefetch" href="/website/blog/assets/js/27.fe4378f8.js"><link rel="prefetch" href="/website/blog/assets/js/28.6f0890d5.js"><link rel="prefetch" href="/website/blog/assets/js/29.6ad4a457.js"><link rel="prefetch" href="/website/blog/assets/js/3.742a7a1e.js"><link rel="prefetch" href="/website/blog/assets/js/30.db2ce232.js"><link rel="prefetch" href="/website/blog/assets/js/31.f991e740.js"><link rel="prefetch" href="/website/blog/assets/js/32.d56dfaeb.js"><link rel="prefetch" href="/website/blog/assets/js/33.93d46f6d.js"><link rel="prefetch" href="/website/blog/assets/js/34.dbe81cd4.js"><link rel="prefetch" href="/website/blog/assets/js/35.7e04ba1f.js"><link rel="prefetch" href="/website/blog/assets/js/36.333b4a68.js"><link rel="prefetch" href="/website/blog/assets/js/38.b648ba2e.js"><link rel="prefetch" href="/website/blog/assets/js/39.bb2de192.js"><link rel="prefetch" href="/website/blog/assets/js/4.cf14bc38.js"><link rel="prefetch" href="/website/blog/assets/js/40.b84b3c27.js"><link rel="prefetch" href="/website/blog/assets/js/41.8382649d.js"><link rel="prefetch" href="/website/blog/assets/js/42.78f45b6f.js"><link rel="prefetch" href="/website/blog/assets/js/43.bc8e996f.js"><link rel="prefetch" href="/website/blog/assets/js/44.32ff1f37.js"><link rel="prefetch" href="/website/blog/assets/js/45.00a4e919.js"><link rel="prefetch" href="/website/blog/assets/js/46.da24a6dc.js"><link rel="prefetch" href="/website/blog/assets/js/47.02039f2b.js"><link rel="prefetch" href="/website/blog/assets/js/48.5f0e9777.js"><link rel="prefetch" href="/website/blog/assets/js/49.2cf784f8.js"><link rel="prefetch" href="/website/blog/assets/js/5.64482bde.js"><link rel="prefetch" href="/website/blog/assets/js/50.fa36e0f8.js"><link rel="prefetch" href="/website/blog/assets/js/51.e2e5684c.js"><link rel="prefetch" href="/website/blog/assets/js/52.a12ef1d5.js"><link rel="prefetch" href="/website/blog/assets/js/53.c582a61e.js"><link rel="prefetch" href="/website/blog/assets/js/54.ac2b27cf.js"><link rel="prefetch" href="/website/blog/assets/js/55.6e071d4d.js"><link rel="prefetch" href="/website/blog/assets/js/56.44fc7909.js"><link rel="prefetch" href="/website/blog/assets/js/57.973853d7.js"><link rel="prefetch" href="/website/blog/assets/js/58.0b14490d.js"><link rel="prefetch" href="/website/blog/assets/js/60.082bbb11.js"><link rel="prefetch" href="/website/blog/assets/js/61.b40fb1a3.js"><link rel="prefetch" href="/website/blog/assets/js/62.b56b6e4e.js"><link rel="prefetch" href="/website/blog/assets/js/63.f43a14f1.js"><link rel="prefetch" href="/website/blog/assets/js/64.c72507b6.js"><link rel="prefetch" href="/website/blog/assets/js/65.f0243d3f.js"><link rel="prefetch" href="/website/blog/assets/js/66.261504f6.js"><link rel="prefetch" href="/website/blog/assets/js/67.61e74772.js"><link rel="prefetch" href="/website/blog/assets/js/68.f7b0033e.js"><link rel="prefetch" href="/website/blog/assets/js/69.603629eb.js"><link rel="prefetch" href="/website/blog/assets/js/70.6c5b77e6.js"><link rel="prefetch" href="/website/blog/assets/js/71.17b1bc7e.js"><link rel="prefetch" href="/website/blog/assets/js/72.34498702.js"><link rel="prefetch" href="/website/blog/assets/js/73.bbc68441.js"><link rel="prefetch" href="/website/blog/assets/js/74.98205159.js"><link rel="prefetch" href="/website/blog/assets/js/75.e371fe5b.js"><link rel="prefetch" href="/website/blog/assets/js/76.e25ba37c.js"><link rel="prefetch" href="/website/blog/assets/js/77.d788a878.js"><link rel="prefetch" href="/website/blog/assets/js/78.a71420c7.js"><link rel="prefetch" href="/website/blog/assets/js/79.ddffbdfc.js"><link rel="prefetch" href="/website/blog/assets/js/8.fc7de73c.js"><link rel="prefetch" href="/website/blog/assets/js/80.cc3773c6.js"><link rel="prefetch" href="/website/blog/assets/js/81.7c76945f.js"><link rel="prefetch" href="/website/blog/assets/js/82.a6809757.js"><link rel="prefetch" href="/website/blog/assets/js/9.4adbc6f5.js">
    <link rel="stylesheet" href="/website/blog/assets/css/0.styles.edf1fc31.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/website/blog/" class="home-link router-link-active"><img src="/website/blog/assets/logo.png" alt="前端小站" class="logo"> <span class="site-name can-hide">前端小站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/website/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/website/blog/component/api/tree.html" class="nav-link">
  组件
</a></div><div class="nav-item"><a href="/website/blog/javascript/闭包/闭包.html" class="nav-link">
  js
</a></div><div class="nav-item"><a href="/website/blog/vue/mvc&amp;&amp;mvvm.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/website/blog/browser/进程.html" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/website/blog/network/http.html" class="nav-link">
  网络
</a></div><div class="nav-item"><a href="/website/blog/webpack/webpack.html" class="nav-link">
  webpack
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/website/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/website/blog/component/api/tree.html" class="nav-link">
  组件
</a></div><div class="nav-item"><a href="/website/blog/javascript/闭包/闭包.html" class="nav-link">
  js
</a></div><div class="nav-item"><a href="/website/blog/vue/mvc&amp;&amp;mvvm.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/website/blog/browser/进程.html" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/website/blog/network/http.html" class="nav-link">
  网络
</a></div><div class="nav-item"><a href="/website/blog/webpack/webpack.html" class="nav-link">
  webpack
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/website/blog/browser/进程.html" class="sidebar-link">进程</a></li><li><a href="/website/blog/browser/浏览器缓存机制.html" class="sidebar-link">浏览器缓存机制</a></li><li><a href="/website/blog/browser/事件流.html" class="sidebar-link">事件流</a></li><li><a href="/website/blog/browser/同源策略.html" class="sidebar-link">同源策略</a></li><li><a href="/website/blog/browser/浏览器url输入的全过程.html" class="sidebar-link">从输入URL到页面展示，这中间发生了什么</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>安全</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/website/blog/browser/安全/网站安全.html" class="active sidebar-link">网站安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#xss-跨站攻击" class="sidebar-link">XSS(跨站攻击)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#表现形式" class="sidebar-link">表现形式</a></li><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#方式" class="sidebar-link">方式</a></li><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#网络劫持" class="sidebar-link">网络劫持</a></li><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#如何阻止-xss-攻击" class="sidebar-link">如何阻止 XSS 攻击</a></li><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#你认为前端开发者对-xss-攻击应该负多大责任？" class="sidebar-link">你认为前端开发者对 XSS 攻击应该负多大责任？</a></li></ul></li><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#csrf攻击-跨站请求伪造" class="sidebar-link">CSRF攻击 跨站请求伪造</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#攻击方式" class="sidebar-link">攻击方式</a></li><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#如何防止-csrf-攻击" class="sidebar-link">如何防止 CSRF 攻击</a></li></ul></li><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#iframe的滥用" class="sidebar-link">IFrame的滥用</a></li><li class="sidebar-sub-header"><a href="/website/blog/browser/安全/网站安全.html#恶意第三方库" class="sidebar-link">恶意第三方库</a></li></ul></li><li><a href="/website/blog/browser/安全/系统安全.html" class="sidebar-link">系统安全</a></li></ul></section></li><li><a href="/website/blog/browser/页面优化.html" class="sidebar-link">页面优化</a></li><li><a href="/website/blog/browser/消息队列.html" class="sidebar-link">消息任务队列</a></li><li><a href="/website/blog/browser/硬件加速.html" class="sidebar-link">硬件加速</a></li><li><a href="/website/blog/browser/垃圾回收/垃圾回收.html" class="sidebar-link">垃圾回收</a></li><li><a href="/website/blog/browser/preformance.html" class="sidebar-link">Performance</a></li><li><a href="/website/blog/browser/PWA.html" class="sidebar-link">PWA</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="网站安全"><a href="#网站安全" class="header-anchor">#</a> 网站安全</h1> <h2 id="xss-跨站攻击"><a href="#xss-跨站攻击" class="header-anchor">#</a> XSS(跨站攻击)</h2> <p>黑客向html页面或者DOM节点注入一段JavaScript恶意脚本，从而用户在浏览页面时，利用恶意脚本对用户产生攻击的一种手段</p> <h3 id="表现形式"><a href="#表现形式" class="header-anchor">#</a> 表现形式</h3> <ul><li><p><code>窃取用户 cookie 信息</code>。通过 document.cookie 获取网站的 cookie 信息，并通过XMLHttpRequest或者fetch通过CORS将获取到的数据发送到恶意服务器。恶意服务器获取到 cookie 信息时，就可以模拟用户的登录行为</p></li> <li><p><code>监听用户行为</code>。恶意脚本可以通过 addEventListener 监听用户键盘输入的行为，这样可以轻松获取用户的一些个人信息，信用卡，身份证信息（比较私密的信息）等，将其发送到 恶意服务器。这样黑客拿到这些信息，就可以做些违法的事情</p></li> <li><p>通过<code>修改 DOM 来轻松的伪造登录页面</code>，欺骗用户输入用户名、密码等</p></li> <li><p><code>页面内生成的悬浮广告</code>，严重影响用户体验</p></li></ul> <h3 id="方式"><a href="#方式" class="header-anchor">#</a> 方式</h3> <ul><li><p>存储型 XSS</p> <ul><li>黑客利用服务器端的漏洞，向页面注入恶意脚本，并存储在服务器</li> <li>当用户访问含有恶意脚本的页面时，就会对用户产生攻击，比如恶意脚本就会将该用户的一些 cookie等信息发送给服务器</li></ul></li> <li><p>反射型 XSS</p> <ul><li>用户将一段带有恶意请求提交给服务器，服务器接收到请求后，将恶意脚本返回给浏览器端</li> <li>Web 服务器不会存储反射型 XSS 攻击的恶意脚本，这是和存储型 XSS 攻击不同的地方</li> <li>表现：黑客经常会通过 QQ 群或者邮件等渠道诱导用户去点击这些恶意链接</li></ul></li> <li><p>基于 DOM 的 XSS</p> <ul><li>基于 dom 的xss 不经过web服务器</li> <li>就是黑客将恶意脚本通过 <code>网络劫持</code> 的方式在页面传输的过程中修改html的代码</li> <li>劫持方式：wifi路由器劫持、本地恶意软件劫持等，共同点： <code>Web 资源传输过程</code>或者在<code>用户使用页面的过程中</code>修改 Web 页面的数据</li></ul></li></ul> <h3 id="网络劫持"><a href="#网络劫持" class="header-anchor">#</a> 网络劫持</h3> <ul><li>DNS劫持
<ul><li>DNS 强制解析：通过修改运营商的本地 DNS 记录，来引导用户流量到缓存服务器</li> <li>302 跳转的方式：通过监控网络出口的流量，分析判断哪些内容可以进行劫持处理，再对劫持的内存发起 302 跳转的回复，引导用户获取内容。</li></ul></li> <li>http劫持
<ul><li>由于 HTTP 明文传输，运营商可能会修改 HTTP 响应内容。如注入广告</li></ul></li></ul> <h3 id="如何阻止-xss-攻击"><a href="#如何阻止-xss-攻击" class="header-anchor">#</a> 如何阻止 XSS 攻击</h3> <p>存储型、反射型 XSS都是需要经过 Web 服务器来处理的，因此可以认为这两种类型的漏洞是<code>服务端的安全漏洞</code></p> <ul><li><p>服务器输入的脚本进行 过滤 和 转码</p></li> <li><p>充分利用CSP（内容安全策略）</p> <ul><li>限制加载其他域下的资源</li> <li>禁止向第三方域提交数据，防止数据泄露</li> <li>禁止执行一些内联脚本，未授权的脚本</li> <li>提供上报机制，可以帮助我们尽快发现有哪些 XSS 攻击，以便尽快修复问题</li></ul></li> <li><p>使用 httpOnly 属性</p> <ul><li>将cookie 设置为 HttpOnly，意思就是 当前设置 HttpOnly的cookie字段只有在http请求的时候才能读取，所以无法通过 JavaScript脚本获取cookie信息</li></ul></li> <li><p>输入内容长度控制</p> <ul><li>对于不受信任的输入，都应该限定一个合理的长度。虽然无法完全防止 XSS 发生，但可以增加 XSS 攻击的难度</li></ul></li> <li><p>验证码</p> <ul><li>防止脚本冒充用户提交危险操作</li></ul></li> <li><p>预防 DOM 型 XSS 攻击：</p> <ul><li>在使用 .innerHTML、.outerHTML、document.write() 时要特别小心，不要把不可信的数据插入到 HTML 页面上，应尽量使用 .textContent、.setAttribute 等。</li> <li>如果使用 React/Vue 技术栈，并且不使用 dangerouslySetInnerHTML/v-html 功能，就在前端 render 阶段避免 innerHTML、outerHTML 的 XSS 隐患。</li> <li>DOM 中的内联事件监听器，如 location、onclick、onerror、onload、onmouseover 等，<code>&lt;a&gt;</code> 标签的 <code>&lt;href&gt;</code> 属性，JavaScript 中的 eval()、setTimeout()、setInterval() 等，都能把字符串作为代码运行。如果不可信的数据拼接到字符串中传递给这些 API，很容易产生安全隐患，请务必避免。</li></ul></li></ul> <h3 id="你认为前端开发者对-xss-攻击应该负多大责任？"><a href="#你认为前端开发者对-xss-攻击应该负多大责任？" class="header-anchor">#</a> 你认为前端开发者对 XSS 攻击应该负多大责任？</h3> <ul><li>首先，用户在向 web服务器 请求html页面时，返回的页面已经注入恶意代码，这个其实最好是在服务器根据在根节点出 杜绝掉 注入恶意代码 的问题，而前端能做的也就是在请求接受到 已经含有恶意代码的页面时，如何将 XSS 对用户的攻击 降到最低。</li> <li>用户在使用 CSP内容安全策略时，也是需要前后端配合的</li></ul> <h2 id="csrf攻击-跨站请求伪造"><a href="#csrf攻击-跨站请求伪造" class="header-anchor">#</a> CSRF攻击 跨站请求伪造</h2> <p>黑客引诱用户打开黑客网站，在黑客网站中，利用用户的登录信息的状态发起跨站请求</p> <p>简单来讲，<code>CSRF 攻击就是黑客利用了用户的登录状态，并通过第三方的站点发起跨站请求，从而来达到他的一些不好目的</code></p> <p>通常调用一些用户登录状态下，一些比较敏感的接口，比如转账、获取个人信息等</p> <p>通常表现为：</p> <div class="language-html extra-class"><pre class="language-html"><code>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>黑客的站点：CSRF攻击演示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 1. 自动发起 Get 请求 --&gt;</span>
    <span class="token comment">&lt;!-- https://time.geekbang.org/sendcoin为api请求接口，user,number为参数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://time.geekbang.org/sendcoin?user=hacker&amp;number=100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>


    <span class="token comment">&lt;!-- 2. 自动发起 POST 请求  自动提交 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>hacker-form<span class="token punctuation">'</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://time.geekbang.org/sendcoin<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>POST</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hacker<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'hacker-form'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>


    <span class="token comment">&lt;!-- 3. 引诱用户点击链接 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>150</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>http://images.xuejuzi.cn/1612/1_161230185104_1.jpg</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>img</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://time.geekbang.org/sendcoin?user=hacker&amp;number=100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">taget</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_blank<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        点击下载美女照片
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h3 id="攻击方式"><a href="#攻击方式" class="header-anchor">#</a> 攻击方式</h3> <ul><li>自动发起 Get 请求</li> <li>自动发起 POST 请求</li> <li>引诱用户点击链接</li></ul> <p><code>和 XSS 不同的是，CSRF 攻击不需要将恶意代码注入用户的页面，仅仅是利用服务器的漏洞和用户的登录状态来实施攻击</code></p> <h3 id="如何防止-csrf-攻击"><a href="#如何防止-csrf-攻击" class="header-anchor">#</a> 如何防止 CSRF 攻击</h3> <ul><li>CSRF产生的条件
<ul><li>目标站点需要有CSRF漏洞</li> <li>用户需要登陆过目标站点，并且当前浏览器仍保留目标站点的登录信息</li> <li>需要打开第三方网站，比如黑客网站</li></ul></li></ul> <h4 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h4> <ol><li><p>充分利用好 cookie 的 SameSite 属性</p> <ul><li><code>Strict</code>（完全禁止第三方cookie）</li> <li><code>Lax</code>（从第三方站点的链接打开和从第三方站点提交 Get 方式的表单这两种方式都会携带 Cookie，但如果在第三方站点中使用 Post 方法，或者通过 img、iframe 等标签加载的 URL，这些场景都不会携带 Cookie）</li> <li><code>None</code>，在任何情况下都会发送 Cookie 数据</li></ul></li> <li><p>验证请求的来源站点</p> <ul><li>在服务器端验证请求来源的站点</li> <li><code>Referer</code> 是 HTTP 请求头中的一个字段，记录了该 HTTP 请求的来源地址，完整的url地址</li> <li><code>Origin</code>是 http 请求来源的 域名</li> <li>Origin  优先级 高于 Referer</li></ul></li> <li><p>CSRF Token</p> <ul><li>浏览器向服务器发起请求时，服务器会产生一个 CSRF Token字符串。然后并返回给浏览器端</li> <li>浏览器在发起一个特定的请求时，需要带上  CSRF Token值，服务器会验证改token是否合法；如果是从第三方站点发出的请求，那么将无法获取到 CSRF Token 的值，所以即使发出了请求，服务器也会因为 CSRF Token 不正确而拒绝请求。</li> <li>注意：<code>针对于请求的，比如同一个浏览器打开两个相同页面，那么服务器为这两个页面生成的csrf token都是不同的</code></li></ul></li></ol> <h2 id="iframe的滥用"><a href="#iframe的滥用" class="header-anchor">#</a> IFrame的滥用</h2> <p>iframe中的内容是由第三方来提供的，默认情况下他们不受我们的控制，他们可以在iframe中运行 JavaScirpt脚本、Flash插件、弹出对话框等等，这可能会破坏前端用户体验</p> <h2 id="恶意第三方库"><a href="#恶意第三方库" class="header-anchor">#</a> 恶意第三方库</h2> <p>无论是后端服务器应用还是前端应用开发，绝大多数时候我们都是在借助开发框架和各种类库进行 快速开发,一旦第三方库被植入恶意代码很容易引起安全问题</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/website/blog/assets/js/app.a3a72a23.js" defer></script><script src="/website/blog/assets/js/7.e5a4a7de.js" defer></script><script src="/website/blog/assets/js/59.d8341454.js" defer></script><script src="/website/blog/assets/js/37.133e5c9b.js" defer></script>
  </body>
</html>
